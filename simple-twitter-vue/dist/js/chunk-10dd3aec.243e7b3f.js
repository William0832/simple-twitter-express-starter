(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10dd3aec"],{"05df":function(e,t,r){"use strict";var s=r("14e0"),n=r.n(s);n.a},"14e0":function(e,t,r){},"1cd8":function(e,t,r){"use strict";var s=r("243b"),n=r.n(s);n.a},"243b":function(e,t,r){},"74f5":function(e,t,r){"use strict";var s=r("c3df"),n=r.n(s);n.a},7950:function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mt-4 d-flex flex-column align-items-start"},[r("img",{attrs:{src:e.user.avatar,width:"250px",height:"250px"}}),r("div",{staticClass:"mt-2 d-flex flex-column align-items-start"},[r("h2",{staticClass:"title"},[e._v(e._s(e.user.name))]),r("p",{staticStyle:{width:"300px","text-align":"left","word-break":"break-all"}},[e._v(e._s(e.user.introduction))]),r("ul",{staticClass:"list-inline list-unstyled"},[r("li",{staticStyle:{"text-align":"left"}},[r("router-link",{attrs:{to:{name:"user",params:{id:e.user.id}}}},[r("strong",[e._v(e._s(e.user.tweetsCount)+" ")]),e._v("Tweets ")])],1),r("li",{staticStyle:{"text-align":"left"}},[r("router-link",{attrs:{to:{name:"users-followings",params:{id:e.user.id}}}},[r("strong",[e._v(e._s(e.user.followingCount))]),e._v(" followings (追蹤者) ")])],1),r("li",{staticStyle:{"text-align":"left"}},[r("router-link",{attrs:{to:{name:"users-followers",params:{id:e.user.id}}}},[r("strong",[e._v(e._s(e.user.followerCount))]),e._v(" followers (追隨者) ")])],1),r("li",{staticStyle:{"text-align":"left"}},[r("router-link",{attrs:{to:{name:"users-likes",params:{id:e.user.id}}}},[r("strong",[e._v(e._s(e.user.likeCount))]),e._v(" Likes ")])],1)]),r("div",{attrs:{id:"follow-btns"}},[e.user.isFollowed||e.user.isCurrentUser?e.user.isFollowed&&!e.user.isCurrentUser?r("button",{staticClass:"btn btn-danger",attrs:{disabled:e.isProcessing,type:"button"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.unfollow(e.user.id)}}},[e._v("取消追蹤")]):r("router-link",{staticClass:"btn btn-primary ml-2",attrs:{to:{name:"users-profile-edit",query:{id:e.user.id}}}},[e._v("edit profile")]):r("button",{staticClass:"btn btn-primary",attrs:{disabled:e.isProcessing,type:"button"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.follow(e.user.id)}}},[e._v("追蹤")])],1)])])},n=[],a=(r("96cf"),r("1da1")),i=r("4cce"),o=r("2fa3"),c={props:{user:{type:Object,required:!0}},data:function(){return{isProcessing:!1}},methods:{follow:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,i["a"].follow(e);case 4:s=r.sent,n=s.data,console.log("data",n),t.$emit("after-follow-user",e),t.isProcessing=!1,r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),t.isProcessing=!1,o["a"].fire({icon:"error",title:"無法加入追蹤，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},unfollow:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,i["a"].unfollow(e);case 4:if(s=r.sent,n=s.data,console.log("data",n),"success"===n.status){r.next=9;break}throw new Error(n.message);case 9:t.$emit("after-unfollow-user",e),t.isProcessing=!1,r.next=17;break;case 13:r.prev=13,r.t0=r["catch"](0),t.isProcessing=!1,o["a"].fire({icon:"error",title:"無法取消追蹤，請稍後再試"});case 17:case"end":return r.stop()}}),r,null,[[0,13]])})))()}}},l=c,u=r("2877"),f=Object(u["a"])(l,s,n,!1,null,null,null);t["a"]=f.exports},b0c6:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container d-flex flex-column flex-grow-1 vh-100 overflow-hidden py-5"},[r("div",{staticClass:"row flex-grow-1 overflow-hidden"},[r("div",{staticClass:"col-md-4 mh-100 overflow-auto"},[r("UserProfileCard",{attrs:{user:e.user}})],1),r("div",{staticClass:"col-md-8 mh-100 overflow-auto"},[r("ReplyTweet",{attrs:{tweet:e.tweet,user:e.user},on:{"after-add-like":e.afterAddLike,"after-delete-like":e.afterDeleteLike}}),r("Replies",{attrs:{replies:e.replies}}),r("ReplyNew",{on:{"after-create-reply":e.afterCreateReply}})],1)])])},n=[],a=(r("96cf"),r("1da1")),i=r("5530"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[e._m(0),r("div",{staticClass:"row border border-secondary rounded my-1"},[r("div",{staticClass:"col-3 d-flex align-items-center justify-content-center"},[r("img",{attrs:{src:e.user.avatar}})]),r("div",{staticClass:"col-8 text-left"},[r("h3",[e._v("@"+e._s(e.user.name)+" , "+e._s(e._f("fromNow")(e.tweet.createdAt)))]),r("p",[e._v(e._s(e.tweet.description))]),r("div",{staticClass:"row justify-content-start"},[e.tweet.isLiked?r("button",{staticClass:"btn btn-danger",attrs:{disabled:e.isProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteLike(e.tweet.id)}}},[e._v("Dislike ")]):r("button",{staticClass:"btn btn-light",attrs:{disabled:e.isProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addLike(e.tweet.id)}}},[e._v("Like ")])])])])])},c=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"row"},[r("h3",[e._v("Tweet")])])}],l=r("2708"),u={mixins:[l["a"]],props:{tweet:{type:Object,required:!0},user:{type:Object,required:!0}},data:function(){return{isProcessing:!1}},methods:{addLike:function(e){var t=this;this.isProcessing=!0,this.$emit("after-add-like",e),setTimeout((function(){t.isProcessing=!1}),500)},deleteLike:function(e){var t=this;this.isProcessing=!0,this.$emit("after-delete-like",e),setTimeout((function(){t.isProcessing=!1}),500)}}},f=u,d=(r("74f5"),r("2877")),p=Object(d["a"])(f,o,c,!1,null,"9cbd30fe",null),m=p.exports,v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[e._m(0),e._l(e.replies,(function(t){return r("div",{key:t.id,staticClass:"row border border-secondary rounded my-1"},[r("div",{staticClass:"col-3 d-flex align-items-center justify-content-center"},[r("img",{attrs:{src:t.User.avatar}})]),r("div",{staticClass:"col-8 text-left"},[r("h3",[r("router-link",{attrs:{to:{name:"user",params:{id:t.User.id}}}},[e._v("@"+e._s(t.User.name))]),e._v(" , "+e._s(e._f("fromNow")(t.createdAt)))],1),r("p",[e._v(e._s(t.comment))])])])}))],2)},w=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"row"},[r("h3",[e._v("Replies")])])}],h={mixins:[l["a"]],props:{replies:{type:Array,required:!0}}},g=h,b=(r("05df"),Object(d["a"])(g,v,w,!1,null,"13c9f20c",null)),k=b.exports,_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{staticClass:"container",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},[r("div",{staticClass:"row form-group mb-4"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment,expression:"comment"}],staticClass:"col form-control",attrs:{rows:"3",name:"reply",placeholder:"What's on your mind?"},domProps:{value:e.comment},on:{input:function(t){t.target.composing||(e.comment=t.target.value)}}})]),r("div",{staticClass:"row d-flex justify-content-end"},[r("div",{staticClass:"col-3"},[r("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(t){return e.$router.back()}}},[e._v("回上一頁")])]),e._m(0)])])},x=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"col-3"},[r("button",{staticClass:"btn btn-primary mr-0",attrs:{type:"submit"}},[e._v("Reply")])])}],y={props:{},data:function(){return{comment:""}},methods:{handleSubmit:function(){this.$emit("after-create-reply",this.comment),this.comment=""}}},C=y,R=(r("1cd8"),Object(d["a"])(C,_,x,!1,null,"053140ea",null)),P=R.exports,j=r("7950"),O=r("2fa3"),$=r("2f62"),U=function(){return localStorage.getItem("token")},E={getTweet:function(e){return O["b"].get("/tweets/".concat(e),{headers:{Authorization:"Bearer ".concat(U())}})},getReplies:function(e){return O["b"].get("/tweets/".concat(e,"/replies\t"),{headers:{Authorization:"Bearer ".concat(U())}})},reply:{create:function(e,t){return O["b"].post("/tweets/".concat(e,"/replies\t"),{comment:t},{headers:{Authorization:"Bearer ".concat(U())},validateStatus:function(e){return e<500}})}}},T=r("4cce"),L=r("7482"),A={components:{ReplyTweet:m,Replies:k,ReplyNew:P,UserProfileCard:j["a"]},data:function(){return{tweet:{},replies:[],user:{id:-1,email:"",name:"",avatar:"",introduction:"",role:"user",isCurrentUser:!1,isFollowed:!1,tweetsCount:0,followingCount:0,followerCount:0,likeCount:0}}},created:function(){var e=this.$route.params.tweet_id;this.fetchTweet(e),this.fetchReplies(e)},computed:Object(i["a"])({},Object($["b"])(["currentUser","isAuthenticated"])),methods:{fetchTweet:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,E.getTweet(e);case 3:s=r.sent,n=s.data,t.tweet=n.tweet,t.user.id=t.tweet.User.id,t.fetchUserProfile(),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),O["a"].fire({icon:"error",title:r.t0});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},fetchReplies:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,E.getReplies(e);case 3:s=r.sent,n=s.data,t.replies=n.tweet.Replies,r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](0),O["a"].fire({icon:"error",title:r.t0});case 11:case"end":return r.stop()}}),r,null,[[0,8]])})))()},fetchUserProfile:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T["a"].getUserProfile(e.user.id);case 3:r=t.sent,s=r.data,e.user=s.user,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),O["a"].fire({icon:"error",title:t.t0});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},afterCreateReply:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,console.log(e),e){r.next=4;break}throw new Error("Reply can not be empty!");case 4:return s=t.$route.params.tweet_id,r.next=7,E.reply.create(s,e);case 7:if(n=r.sent,a=n.data,"success"===a.status){r.next=11;break}throw new Error(a.message);case 11:t.fetchReplies(s),console.log("reply notify"),t.$socket.emit("reply",{userId:t.currentUser.id,tweetId:s,type:"reply"}),r.next=20;break;case 16:r.prev=16,r.t0=r["catch"](0),console.log(r.t0),O["a"].fire({icon:"error",title:r.t0});case 20:case"end":return r.stop()}}),r,null,[[0,16]])})))()},afterAddLike:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,console.log(e),r.next=4,L["a"].tweets.like(e);case 4:if(s=r.sent,n=s.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:t.fetchTweet(e),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](0),O["a"].fire({icon:"error",title:r.t0});case 14:case"end":return r.stop()}}),r,null,[[0,11]])})))()},afterDeleteLike:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,console.log(e),r.next=4,L["a"].tweets.unlike(e);case 4:if(s=r.sent,n=s.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:t.fetchTweet(e),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](0),O["a"].fire({icon:"error",title:r.t0});case 14:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}},S=A,D=Object(d["a"])(S,s,n,!1,null,null,null);t["default"]=D.exports},c3df:function(e,t,r){}}]);
//# sourceMappingURL=chunk-10dd3aec.243e7b3f.js.map